/*!
 * ViewTable v1.2.1 - ViewTable JS
 * Description: ViewTable is a JavaScript library that transforms HTML table structures 
 * into a mobile-friendly layout with a toggle rows system. It dynamically converts 
 * table HTML markup into an optimized format for mobile viewing and interaction.
 * @copyright 2025
 * @author    Ali Musthofa
 * @link      https://github.com/alicom13/viewtable
 * @license   MIT
 */

(function(){'use strict';class t{constructor(e){this.table=e,this.config={mobileCols:e.dataset.mobileCols?e.dataset.mobileCols.split(",").map(t=>t.trim()):null,breakpoint:768},this.mobileContainer=null,this.init()}init(){this.createMobileContainer(),this.checkView(),window.addEventListener("resize",()=>this.checkView())}createMobileContainer(){this.mobileContainer=document.createElement("div"),this.mobileContainer.className="viewtable-mobile-container",this.table.parentNode.insertBefore(this.mobileContainer,this.table.nextSibling)}generateMobileView(){const t=Array.from(this.table.querySelectorAll("thead th")).map(t=>t.textContent.trim()),e=this.table.querySelectorAll("tbody tr"),n=this.config.mobileCols||t.slice(0,3),o=t.filter(t=>!n.includes(t));let s=`<div class="viewtable-mobile-table"><div class="viewtable-mobile-header">`;n.forEach(t=>{s+=`<div class="viewtable-mobile-col">${t}</div>`}),s+=`<div class="viewtable-mobile-col-toggle"></div></div>`,e.forEach((e,i)=>{const r=Array.from(e.querySelectorAll("td"));s+=`<div class="viewtable-mobile-row" data-row-index="${i}"><div class="viewtable-mobile-row-main">`,n.forEach(e=>{const n=t.indexOf(e),o=r[n]?r[n].innerHTML.trim():"";s+=`<div class="viewtable-mobile-cell">${o}</div>`}),s+=`<div class="viewtable-mobile-toggle"><span class="viewtable-toggle-arrow">▼</span></div></div><div class="viewtable-mobile-details" id="mobile-details-${i}">`,o.forEach(e=>{const n=t.indexOf(e);r[n]&&(s+=`<div class="viewtable-detail-item"><span class="viewtable-detail-label">${e}:</span><span class="viewtable-detail-value">${r[n].innerHTML.trim()}</span></div>`)})}),this.mobileContainer.innerHTML=s+`</div></div></div>`,this.mobileContainer.addEventListener("click",t=>{const e=t.target.closest(".viewtable-mobile-row");e&&this.toggleRowDetails(e)})}toggleRowDetails(t){const e=t.dataset.rowIndex,n=document.getElementById(`mobile-details-${e}`),o=t.querySelector(".viewtable-toggle-arrow");if(!n)return;const s="block"===n.style.display;n.style.display=s?"none":"block",o.textContent=s?"▼":"▲"}checkView(){const t=window.innerWidth<=this.config.breakpoint;t?(this.table.style.display="none",this.mobileContainer.style.display="block",0===this.mobileContainer.children.length&&this.generateMobileView()):(this.table.style.display="table",this.mobileContainer.style.display="none")}}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("[data-viewtable]").forEach(e=>{new t(e)})});})();
